---
title: 概述 & 目录
topic: fang12306
---

## 概述

本项目旨在构建一个高性能、高可用的分布式票务系统。核心技术挑战在于解决高并发下的数据一致性。

---

V1 完成业务功能，基本实现不超卖和一致性

V2 MP重构后端代码，更加简介易读

V3 最佳实践，性能优化

---

## 目录

### 系统设计

技术栈	核心功能	核心模块	系统架构	数据库表

### 技术实现概述

难点	技术亮点

### 功能实现

> 功能目标---技术选型---技术实现---解决的具体问题/亮点

余票查询和扣减	防止刷票	JWT单点登录	网关层拦截器	服务层拦截器	AOP方法级日志	异常处理	线程本地变量	异常与边界场景处理	

Redis	RocketMQ	Seata	Sentinel	Nacos	MySQL	MyBatis	Gateway网关	业务模块

### 组件/框架/中间件集成与配置

>应用场景---选型理由---解决问题

Nacos	Seata	Sentinel	RocketMQ	Redis	MySQL	

MyBatis持久层框架	PageHelper分页插件	Validation校验框架	雪花算法生成分布式 ID	Quartz调度框架	OpenFeign框架	Kaptcha图形验证码库	

Gateway网关	业务模块

### 高并发和性能优化

>问题分析-解决方案

如何保证不超卖	余票数据的特殊处理	如何保证数据一致性	如何应对秒杀	如何保证消息不丢失

### 分布式和微服务相关

>动机---方案---效果

如何管理用户登录状态	服务拆分	分布式事务	API幂等性设计

### 压测



### 问题排查解决



### 反思总结

系统扩展性	进一步优化

## 其他

进入指定目录

```shell
D:;cd D:\study\Nu11Cat\Imitation-of-12306-ticketing-system\
```

启动客户端前端

```shell
cd train/web; npm run web-dev 
```

启动管理台前端

```shell
cd train/admin; npm run admin-dev
```

单机模式启动 Nacos 服务

```shell
cd nacos/bin; .\startup.cmd -m standalone
```

启动 Seata 服务

```shell
cd seata/bin; .\seata-server.bat
```

运行 Sentinel 控制台

```she
java -jar sentinel-dashboard-1.8.6.jar
```

启动 RocketMQ 的命名服务

```shell
cd ../rocketmq-all-4.9.5-bin-release/bin; start mqnamesrv.cmd
```

启动 RocketMQ 的 Broker 服务，并指定连接的 NameServer 地址为本地 127.0.0.1:9876

```shell
cd ../rocketmq-all-4.9.5-bin-release/bin; .\mqbroker.cmd -n 127.0.0.1:9876
```

（清空D:\rocketmq-data\store，管理员身份cmd）

```shell
cd ../rocketmq-all-4.9.5-bin-release/bin; mqbroker.cmd -n 127.0.0.1:9876 -c ..\conf\broker.conf
```

关闭指定端口的服务

```shell
for /f "tokens=5" %a in ('netstat -ano ^| findstr :8000') do taskkill /PID %a /F
```

```shell
for /f "tokens=5" %a in ('netstat -ano ^| findstr :8001') do taskkill /PID %a /F
```

```shell
for /f "tokens=5" %a in ('netstat -ano ^| findstr :8002') do taskkill /PID %a /F
```

```shell
for /f "tokens=5" %a in ('netstat -ano ^| findstr :8003') do taskkill /PID %a /F
```



1，mq依赖

2，lombok

3，`@GlobalTransactional` 与 MySQL 保留字列名在 **分布式事务代理/SQL解析层** 产生了冲突

Seata 全局事务解析 SQL 时未正确处理保留字列名

- 1，改字段

- 2：

@TableField("``row``")
private String row;

@TableField("``col``")
private String col;

- 3：



-- 修改字段名，同时保持字段类型
ALTER TABLE train_seat 
    CHANGE `row` `row_index` varchar(10) NOT NULL COMMENT '行号',
    CHANGE `col` `col_index` varchar(10) NOT NULL COMMENT '列号';













