---
title : Docker
wiki: devops_and_toolchain
---

# 基础

## 容器

**容器就是将软件打包成标准化单元，以用于开发、交付和部署。**

容器是一种**轻量级、可移植、自包含的软件运行环境**，它将应用程序及其运行所需的依赖、库、配置等打包在一起，确保在任何环境中都能以一致的方式运行。

容器并不是虚拟机，它不需要启动完整的操作系统，而是**共享宿主机的内核**，因此启动速度更快、资源开销更小。容器通过操作系统层的虚拟化（如 Linux 的命名空间和 cgroups）来实现**进程隔离和资源限制**，保障应用之间的安全与稳定。

容器最大的优势是：**“一次构建，到处运行”**。开发、测试和生产环境中使用同一个镜像，大大提高了部署效率和环境一致性。常见的容器技术包括 Docker、containerd 等。

## Docker基础

**Docker是什么**

Docker 是一个开源的**容器化平台**，用于将应用及其依赖打包成一个统一的容器镜像，并在隔离的环境中运行。它基于 Linux 的容器技术（如 namespaces 和 cgroups），实现了轻量级的进程级虚拟化，支持快速构建、交付和部署应用，是现代 DevOps 和云原生架构的重要基础设施。

---

**Docker有什么特点**

- **轻量级**：容器共享宿主机内核，不像虚拟机那样需要完整操作系统，启动快、资源占用低。
- **快速部署**：镜像打包好后可秒级启动，大大提升交付效率。
- **环境一致性**：开发、测试、生产使用同一个镜像，避免“在我这没问题”的情况。
- **易于移植**：一次构建，任意运行，无论是在本地、测试机还是云上。
- **模块化**：每个容器只运行一个服务，天然支持微服务架构。
- **便于版本控制和回滚**：镜像支持版本管理，随时还原。

---

**为什么要使用Docker**

使用 Docker 可以大大简化应用的部署流程，解决传统开发中环境不一致、部署慢、依赖冲突等问题。它让应用更容易迁移、更易扩展，特别适合微服务架构和持续集成/持续交付（CI/CD）场景。同时，Docker 还能提升资源利用率，降低运维成本，是现代应用开发中非常重要的基础设施工具。

---

## Docker基础概念

Docker 中有非常重要的三个基本概念：镜像（Image）、容器（Container）和仓库（Repository）。

---

### 镜像

**Docker 镜像是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。** 镜像不包含任何动态数据，其内容在构建之后也不会被改变。

Docker 设计时，就充分利用 **Union FS** 的技术，将其设计为**分层存储的架构** 。镜像实际是由多层文件系统联合组成。

**镜像构建时，会一层层构建，前一层是后一层的基础。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。** 比如，删除前一层文件的操作，实际不是真的删除前一层的文件，而是仅在当前层标记为该文件已删除。在最终容器运行的时候，虽然不会看到这个文件，但是实际上该文件会一直跟随镜像。因此，在构建镜像的时候，需要额外小心，每一层尽量只包含该层需要添加的东西，任何额外的东西应该在该层构建结束前清理掉。

分层存储的特征还使得镜像的复用、定制变的更为容易。甚至可以用之前构建好的镜像作为基础层，然后进一步添加新的层，以定制自己所需的内容，构建新的镜像。

------

### 容器

镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的 类 和 实例 一样，镜像是静态的定义，**容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等** 。

**容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的 命名空间。前面讲过镜像使用的是分层存储，容器也是如此。**

**容器存储层的生存周期和容器一样，容器消亡时，容器存储层也随之消亡。因此，任何保存于容器存储层的信息都会随容器删除而丢失。**

按照 Docker 最佳实践的要求，**容器不应该向其存储层内写入任何数据** ，容器存储层要保持无状态化。**所有的文件写入操作，都应该使用数据卷（Volume）、或者绑定宿主目录**，在这些位置的读写会跳过容器存储层，直接对宿主(或网络存储)发生读写，其性能和稳定性更高。数据卷的生存周期独立于容器，容器消亡，数据卷不会消亡。因此， **使用数据卷后，容器可以随意删除、重新 run ，数据却不会丢失。**

------

### 仓库

镜像构建完成后，可以很容易的在当前宿主上运行，但是， **如果需要在其它服务器上使用这个镜像，我们就需要一个集中的存储、分发镜像的服务，Docker Registry 就是这样的服务。**

一个 Docker Registry 中可以包含多个仓库（Repository）；每个仓库可以包含多个标签（Tag）；每个标签对应一个镜像。所以说：**镜像仓库是 Docker 用来集中存放镜像文件的地方类似于我们之前常用的代码仓库。**

通常，**一个仓库会包含同一个软件不同版本的镜像**，而**标签就常用于对应该软件的各个版本** 。我们可以通过`<仓库名>:<标签>`的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 latest 作为默认标签.。

------

# 常用命令

[Docker 常见命令](https://javaguide.cn/tools/docker/docker-intro.html#docker-常见命令)



































